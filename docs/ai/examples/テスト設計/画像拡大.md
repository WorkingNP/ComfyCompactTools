# テスト設計例：画像拡大機能

## 入力（チケットのUser Journey）

```markdown
### 操作の流れ
1. 画像が表示されている
2. 画像をクリックする
3. 画像が拡大される
4. もう一度クリックすると元に戻る

### 成功条件
- 拡大後の画像が画面内に収まっている

### 失敗条件
- 画像が見切れる（スクロールが必要になる）
```

---

## テストケース設計

### テストケース 1: 拡大する

#### 前提条件
- 画像一覧ページが表示されている
- 少なくとも1枚の画像が表示されている

#### 操作
1. 画像をクリックする

#### 成功条件（検証ポイント）
- [ ] 画像が拡大表示される（元のサイズより大きい）
- [ ] 拡大後の画像がビューポート内に収まっている
- [ ] 横スクロールバーが出現しない
- [ ] 縦スクロールバーが出現しない（または許容範囲内）

#### 失敗条件（これが起きたらNG）
- 画像が画面外にはみ出す
- スクロールしないと画像全体が見えない

---

### テストケース 2: 元に戻す

#### 前提条件
- 画像が拡大表示されている

#### 操作
1. 拡大された画像をクリックする

#### 成功条件（検証ポイント）
- [ ] 画像が元のサイズに戻る
- [ ] 一覧表示に戻る

---

### セレクタ方針

```
優先順位:
1. getByRole('img') または getByRole('button')
2. getByTestId('image-viewer')
3. locator('.image-container img')

推奨data-testid:
- data-testid="gallery-image" （一覧の各画像）
- data-testid="expanded-image" （拡大表示の画像）
```

---

## Playwrightでの検証例

```typescript
// 画像が画面内に収まっているかの検証
const image = page.getByTestId('expanded-image');
const box = await image.boundingBox();
const viewport = page.viewportSize();

expect(box.x).toBeGreaterThanOrEqual(0);
expect(box.y).toBeGreaterThanOrEqual(0);
expect(box.x + box.width).toBeLessThanOrEqual(viewport.width);
expect(box.y + box.height).toBeLessThanOrEqual(viewport.height);
```

---

## 次のステップ
この設計を `/playwright-acceptance` に渡してテストコード化する。
